function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{X13c:function(t,e,o){"use strict";o.r(e);var n=o("ofXK"),i=o("3Pt+"),r=o("lDzL"),a=o("fXoL"),c=o("8laU"),s=o("5eHb"),b=o("/nqz"),p=o("tyNb");function g(t,e){if(1&t&&(a.Wb(0,"option",31),a.Jc(1),a.Vb()),2&t){var o=e.$implicit;a.qc("value",o.agent_code),a.Cb(1),a.Lc("",o.name," ")}}function l(t,e){if(1&t&&(a.Wb(0,"option",31),a.Jc(1),a.Vb()),2&t){var o=e.$implicit;a.qc("value",o.supplier_id),a.Cb(1),a.Lc(" ",o.name,"")}}function d(t,e){if(1&t){var o=a.Xb();a.Wb(0,"div",32),a.Wb(1,"div",33),a.Jc(2,"Ticket Log"),a.Vb(),a.Wb(3,"div",34),a.Wb(4,"button",35),a.ec("click",(function(t){return a.Ac(o),a.ic().exportTicket()})),a.Jc(5," Export "),a.Vb(),a.Vb(),a.Vb()}}function u(t,e){if(1&t&&(a.Wb(0,"span"),a.Jc(1),a.Vb()),2&t){var o=a.ic(2).row;a.Cb(1),a.Lc(" ",o.bookings_flight.TicketContact[0].Surname," ")}}function m(t,e){if(1&t&&(a.Wb(0,"span"),a.Hc(1,u,2,1,"span",50),a.Vb()),2&t){var o=a.ic().row;a.Cb(1),a.pc("ngIf",null!=o.bookings_flight.TicketContact[0].Surname)}}function f(t,e){1&t&&a.Hc(0,m,2,1,"span",50),2&t&&a.pc("ngIf",null!=e.row.bookings_flight.TicketContact)}function h(t,e){1&t&&a.Jc(0),2&t&&a.Lc(" ",e.row.bookings_flight.supplier.name," ")}function k(t,e){1&t&&a.Jc(0),2&t&&a.Lc(" ",e.row.bookings_flight.booking_status," ")}function _(t,e){1&t&&(a.Jc(0),a.jc(1,"date")),2&t&&a.Lc(" ",a.lc(1,1,e.row.bookings_flight.created,"dd/MM/yyyy")," ")}var C=function(){return{prop:"id",dir:"desc"}},v=function(t){return[t]};function O(t,e){if(1&t&&(a.Wb(0,"div",38),a.Wb(1,"ngx-datatable",39,40),a.Rb(3,"ngx-datatable-column",41),a.Rb(4,"ngx-datatable-column",42),a.Rb(5,"ngx-datatable-column",43),a.Rb(6,"ngx-datatable-column",44),a.Wb(7,"ngx-datatable-column",45),a.Hc(8,f,1,1,"ng-template",46),a.Vb(),a.Wb(9,"ngx-datatable-column",47),a.Hc(10,h,1,1,"ng-template",46),a.Vb(),a.Wb(11,"ngx-datatable-column",48),a.Hc(12,k,1,1,"ng-template",46),a.Vb(),a.Wb(13,"ngx-datatable-column",49),a.Hc(14,_,2,4,"ng-template",46),a.Vb(),a.Vb(),a.Vb()),2&t){var o=a.ic(2);a.Cb(1),a.pc("columnMode","force")("headerHeight",50)("footerHeight",50)("rowHeight","auto")("limit",10)("rows",o.NewTicketReport)("sortType","multi")("reorderable",!0)("sorts",a.uc(10,v,a.tc(9,C)))}}function x(t,e){if(1&t&&(a.Wb(0,"div",36),a.Hc(1,O,15,12,"div",37),a.Vb()),2&t){var o=a.ic();a.Cb(1),a.pc("ngIf",o.showTicketReport)}}function w(t,e){1&t&&(a.Wb(0,"div",52),a.Wb(1,"div",53),a.Wb(2,"div",54),a.Jc(3,"Loading Report..."),a.Vb(),a.Vb(),a.Rb(4,"p"),a.Vb())}function M(t,e){if(1&t&&(a.Wb(0,"div",36),a.Hc(1,w,5,0,"div",51),a.Vb()),2&t){var o=a.ic();a.Cb(1),a.pc("ngIf",o.bookingsLoader)}}function P(t,e){1&t&&(a.Wb(0,"div",32),a.Wb(1,"div",33),a.Jc(2,"Ticket Log"),a.Vb(),a.Wb(3,"div",34),a.Wb(4,"button",55),a.Jc(5," Export "),a.Vb(),a.Vb(),a.Vb())}function V(t,e){if(1&t&&(a.Wb(0,"span"),a.Jc(1),a.Vb()),2&t){var o=a.ic(2).row;a.Cb(1),a.Lc(" ",o.bookings_flight.TicketContact[0].Surname,"")}}function W(t,e){if(1&t&&(a.Wb(0,"span"),a.Hc(1,V,2,1,"span",50),a.Vb()),2&t){var o=a.ic().row;a.Cb(1),a.pc("ngIf",null!=o.bookings_flight.TicketContact[0].Surname)}}function y(t,e){1&t&&a.Hc(0,W,2,1,"span",50),2&t&&a.pc("ngIf",e.row.bookings_flight.TicketContact)}function L(t,e){1&t&&a.Jc(0),2&t&&a.Lc(" ",e.row.bookings_flight.supplier.name," ")}function R(t,e){1&t&&a.Jc(0),2&t&&a.Lc(" ",e.row.bookings_flight.booking_status," ")}function T(t,e){1&t&&(a.Jc(0),a.jc(1,"date")),2&t&&a.Lc(" ",a.lc(1,1,e.row.bookings_flight.created,"dd/MM/yyyy")," ")}function H(t,e){if(1&t&&(a.Wb(0,"div",38),a.Wb(1,"ngx-datatable",39,40),a.Rb(3,"ngx-datatable-column",41),a.Rb(4,"ngx-datatable-column",42),a.Rb(5,"ngx-datatable-column",43),a.Rb(6,"ngx-datatable-column",44),a.Wb(7,"ngx-datatable-column",45),a.Hc(8,y,1,1,"ng-template",46),a.Vb(),a.Wb(9,"ngx-datatable-column",47),a.Hc(10,L,1,1,"ng-template",46),a.Vb(),a.Wb(11,"ngx-datatable-column",48),a.Hc(12,R,1,1,"ng-template",46),a.Vb(),a.Wb(13,"ngx-datatable-column",49),a.Hc(14,T,2,4,"ng-template",46),a.Vb(),a.Vb(),a.Vb()),2&t){var o=a.ic(2);a.Cb(1),a.pc("columnMode","force")("headerHeight",50)("footerHeight",50)("rowHeight","auto")("limit",10)("rows",o.NewTicketReport)("sortType","multi")("reorderable",!0)("sorts",a.uc(10,v,a.tc(9,C)))}}function S(t,e){if(1&t&&(a.Wb(0,"div",36),a.Hc(1,H,15,12,"div",37),a.Vb()),2&t){var o=a.ic();a.Cb(1),a.pc("ngIf",o.showTicketReport)}}var D,J,I=[{path:"",component:(D=function(){function t(e,o,n,r){var a=this;_classCallCheck(this,t),this.fb=e,this.reportService=o,this.toastr=n,this.excelService=r,this.agents=[],this.productLists=[],this.suppliers=[],this.ticketReportObj={},this.showTicketReport=!1,this.bookingsLoader=!1,this.submitted=!1,this.pages=0,this.limit=15,this.pageIndex=1,this.ticketReportForm=this.fb.group({agentList:[""],productList:[""],supplierList:[""],ticketStartDate:["",[i.z.required]],ticketEndDate:["",[i.z.required]]}),this.ticketSearch=function(){a.bookingsLoader=!0,a.submitted=!0,a.ticketReportForm.invalid||(a.showTicketReport=!0,a.ticketReportObj.product=a.ticketReportForm.get("productList").value,a.ticketReportObj.supplier_id=a.ticketReportForm.get("supplierList").value,a.ticketReportObj.agent_codes=a.ticketReportForm.get("agentList").value,a.ticketReportObj.start_date=a.ticketReportForm.get("ticketStartDate").value,a.ticketReportObj.end_date=a.ticketReportForm.get("ticketEndDate").value,a.reportService.searchTicketReport(a.ticketReportObj).subscribe((function(t){"data"==t.type?(a.bookingsLoader=!1,0!=t.Data.length?(a.NewTicketReport=t.Data,a.NewTicketReport.map((function(e,o){e.trip_id=null!=e.booking?t.Data[o].booking.trip_id:"---"})),a.showTicketReport=!0):(a.bookingsLoader=!1,a.toastr.info("there is no data available to display","",{timeOut:1e3,progressBar:!1,positionClass:"toast-bottom-right"}))):(a.bookingsLoader=!1,a.toastr.error("".concat(t.msg),"".concat(t.msg),{timeOut:1e3,progressBar:!1,positionClass:"toast-bottom-right"}))})))},this.reset=function(){a.ticketReportForm.reset(),$(".ui.dropdown").dropdown("clear"),a.showTicketReport=!1,a.bookingsLoader=!1}}return _createClass(t,[{key:"ngOnInit",value:function(){this.fetchAllAgents(),this.fetchAllProducts(this.limit,this.pageIndex),this.fetchAllSuppliers()}},{key:"ngAfterViewInit",value:function(){$(document).ready((function(){$(".menu .item").tab(),$(".ui.dropdown").dropdown(),$(".dropdownFive").dropdown({placeholder:"Choose agents"})})),this.loadStartDate(),this.loadEndDate()}},{key:"loadEndDate",value:function(){var t=this;$((function(){$('input[name="ticketEndDate"]').daterangepicker({singleDatePicker:!0,showDropdowns:!0,autoUpdateInput:!1},(function(e,o,n){moment().diff(e,"years"),t.ticketReportForm.get("ticketEndDate").setValue(moment(e).format("YYYY-MM-DD"))}))}))}},{key:"loadStartDate",value:function(){var t=this;$((function(){$('input[name="ticketStartDate"]').daterangepicker({singleDatePicker:!0,showDropdowns:!0,autoUpdateInput:!1},(function(e,o,n){moment().diff(e,"years"),t.ticketReportForm.get("ticketStartDate").setValue(moment(e).format("YYYY-MM-DD"))}))}))}},{key:"fetchAllAgents",value:function(){var t=this;this.bookingsLoader=!0,this.reportService.GetAllAgents().subscribe((function(e){"data"==e.type?(t.bookingsLoader=!1,0!=e.Organization.length?t.agents=e.Organization:t.toastr.info("There is no agents to display","".concat(e.msg),{timeOut:1e3,progressBar:!1,positionClass:"toast-bottom-right"})):(t.bookingsLoader=!1,t.toastr.error("".concat(e.msg),"".concat(e.msg),{timeOut:1e3,progressBar:!1,positionClass:"toast-bottom-right"}))}))}},{key:"fetchAllProducts",value:function(t,e){var o=this;this.bookingsLoader=!0,this.reportService.GetAllProducts(0,t,e).subscribe((function(t){if("data"==t.type)if(o.bookingsLoader=!1,0!=t.Data.length)for(var e=t.Data,n=Object.keys(t.Data),i=0;i<n.length;i++){var r=n[i];1==e[r]&&o.productLists.push(r)}else o.toastr.info("There is no product to display","".concat(t.msg),{timeOut:1e3,progressBar:!1,positionClass:"toast-bottom-right"});else o.bookingsLoader=!1,o.toastr.error("".concat(t.msg),"".concat(t.msg),{timeOut:1e3,progressBar:!1,positionClass:"toast-bottom-right"})}))}},{key:"fetchAllSuppliers",value:function(){var t=this;this.bookingsLoader=!0,this.reportService.GetAllSuppliers().subscribe((function(e){e.status?(t.bookingsLoader=!1,0!=e.result.length?t.suppliers=e.result:t.toastr.info("There is no suppliers available","",{timeOut:1e3,progressBar:!1,positionClass:"toast-bottom-right"})):(t.bookingsLoader=!1,t.toastr.error("".concat(e.messsage),"",{timeOut:1e3,progressBar:!1,positionClass:"toast-bottom-right"}))}))}},{key:"exportTicket",value:function(){var t=this;this.reportService.exportTicket(this.ticketReportObj).subscribe((function(e){"error"!=e.type?t.excelService.exportAsExcelFile(e.Data,"bookings"):t.toastr.error("".concat(e.message),"".concat(e.message),{timeOut:1e4,progressBar:!1,positionClass:"toast-bottom-right"})}))}},{key:"f",get:function(){return this.ticketReportForm.controls}}]),t}(),D.\u0275fac=function(t){return new(t||D)(a.Qb(i.f),a.Qb(c.a),a.Qb(s.b),a.Qb(b.a))},D.\u0275cmp=a.Kb({type:D,selectors:[["app-ticket-report"]],decls:53,vars:8,consts:[[1,"ui","top","attached","tabular","menu"],["data-tab","first","routerLink","/report/booking-report",1,"item"],["data-tab","second","routerLink","/report/segment-report",1,"item"],["data-tab","third","routerLink","/report/mis-report",1,"item"],["data-tab","fourth","routerLink","/report/search-log-report",1,"item"],["data-tab","fifth","routerLink","/report/audit-report",1,"item"],["data-tab","sixth","routerLink","/report/ticket-report",1,"item","active"],["data-tab","seventh","routerLink","/report/dynamic-report",1,"item"],["data-tab","sixth",1,"ui","bottom","attached","tab","segment","tabContent-block","active"],[1,"ui","segment"],[1,"ui","fluid","container"],[1,"outer-basics"],[1,"ui","form","report-form",3,"formGroup","ngSubmit"],[1,"field"],[1,"outer-basicForm"],[1,"form-inner"],[1,"fields"],[1,"five","wide","field"],["formControlName","agentList","multiple","",1,"ui","fluid","search","dropdownFive","multiple_search"],["class","item",3,"value",4,"ngFor","ngForOf"],["formControlName","productList",1,"ui","fluid","search","dropdown"],["value",""],["value","flights",1,"item"],[1,"four","wide","field"],["formControlName","supplierList",1,"ui","fluid","search","dropdown"],["class","fields agent-name-booking",4,"ngIf"],["class","result-block",4,"ngIf"],[1,"bookings_btn-panel"],["title","Reset",1,"ui","primary","reset","button",3,"click"],[1,"undo","icon"],[1,"ui","primary","button"],[1,"item",3,"value"],[1,"fields","agent-name-booking"],[1,"eight","wide","field","ui","small","header"],[1,"eight","wide","field","bookings_btn-panel"],["title","Export",1,"ui","export","button",3,"click"],[1,"result-block"],["class","user-table-list b2c-list-user-table",4,"ngIf"],[1,"user-table-list","b2c-list-user-table"],[1,"table",3,"columnMode","headerHeight","footerHeight","rowHeight","limit","rows","sortType","reorderable","sorts"],["table",""],["name","Ticket Number","prop","ticket_number"],["name","Trip Id","prop","trip_id"],["name","Base Ammount","prop","BaseFare"],["name","Fee and Tax","prop","Tax"],["name","Passenger Name"],["ngx-datatable-cell-template",""],["name","Supplier Code"],["name","Booking Status"],["name","Booked Date"],[4,"ngIf"],["class","ui segment b2c-list-user-table__segment-loader",4,"ngIf"],[1,"ui","segment","b2c-list-user-table__segment-loader"],[1,"ui","active","inverted","dimmer"],[1,"ui","text","loader"],["title","Export",1,"ui","export","button"]],template:function(t,e){1&t&&(a.Wb(0,"div",0),a.Wb(1,"div",1),a.Jc(2," Booking "),a.Vb(),a.Wb(3,"div",2),a.Jc(4,"Segment"),a.Vb(),a.Wb(5,"div",3),a.Jc(6,"MIS"),a.Vb(),a.Wb(7,"div",4),a.Jc(8,"Search Log"),a.Vb(),a.Wb(9,"div",5),a.Jc(10,"Audit Trail Log"),a.Vb(),a.Wb(11,"div",6),a.Jc(12,"Ticket"),a.Vb(),a.Wb(13,"div",7),a.Jc(14,"Dynamic Report"),a.Vb(),a.Vb(),a.Wb(15,"div",8),a.Wb(16,"div",9),a.Wb(17,"div",10),a.Wb(18,"div",11),a.Wb(19,"form",12),a.ec("ngSubmit",(function(t){return e.ticketSearch()})),a.Wb(20,"div",13),a.Wb(21,"div",14),a.Wb(22,"div",15),a.Wb(23,"div",16),a.Wb(24,"div",17),a.Wb(25,"label"),a.Jc(26,"Agents"),a.Vb(),a.Wb(27,"select",18),a.Hc(28,g,2,2,"option",19),a.Vb(),a.Vb(),a.Wb(29,"div",17),a.Wb(30,"label"),a.Jc(31,"Products"),a.Vb(),a.Wb(32,"select",20),a.Wb(33,"option",21),a.Jc(34,"Choose Products"),a.Vb(),a.Wb(35,"option",22),a.Jc(36,"Flights"),a.Vb(),a.Vb(),a.Vb(),a.Wb(37,"div",23),a.Wb(38,"label"),a.Jc(39,"Suppliers"),a.Vb(),a.Wb(40,"select",24),a.Hc(41,l,2,2,"option",19),a.Vb(),a.Vb(),a.Vb(),a.Hc(42,d,6,0,"div",25),a.Hc(43,x,2,1,"div",26),a.Wb(44,"div",17),a.Wb(45,"div",27),a.Wb(46,"button",28),a.ec("click",(function(t){return e.reset()})),a.Rb(47,"i",29),a.Vb(),a.Wb(48,"button",30),a.Jc(49," Search "),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Hc(50,M,2,1,"div",26),a.Hc(51,P,6,0,"div",25),a.Hc(52,S,2,1,"div",26),a.Vb(),a.Vb(),a.Vb(),a.Vb()),2&t&&(a.Cb(19),a.pc("formGroup",e.ticketReportForm),a.Cb(9),a.pc("ngForOf",e.agents),a.Cb(13),a.pc("ngForOf",e.suppliers),a.Cb(1),a.pc("ngIf",e.showTicketReport),a.Cb(1),a.pc("ngIf",e.showTicketReport),a.Cb(7),a.pc("ngIf",e.bookingsLoader),a.Cb(1),a.pc("ngIf",e.showTicketReport),a.Cb(1),a.pc("ngIf",e.showTicketReport))},directives:[p.g,i.B,i.p,i.i,i.y,i.o,i.h,n.o,i.x,i.s,i.A,n.p,r.c,r.b,r.a],pipes:[n.f],styles:[".bookings_btn-panel[_ngcontent-%COMP%]{padding:20px 2px}.bookings_pickers[_ngcontent-%COMP%]   .input.bookings_datepicker[_ngcontent-%COMP%]{min-width:120px;max-width:138px}.bookings_pickers[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .ui.basic.floating.button[_ngcontent-%COMP%]{padding:10px!important;color:hsla(0,0%,59.6%,.6)!important;font-weight:300!important;line-height:11px}.bookings_pickers[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{opacity:1;z-index:1}.bookings_pickers[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .bookings_input__placeholder-icon[_ngcontent-%COMP%]{width:24px;margin-top:6px}.bookings_pickers[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .bookings_input__placeholder-icon.cal[_ngcontent-%COMP%]{width:18px;margin-top:10px}.bookings_pickers[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .search.dropdown[_ngcontent-%COMP%]{width:218px;border-right:0;border-top-left-radius:5px;border-bottom-left-radius:5px}.bookings_pickers[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .search.dropdown[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{margin-left:42px!important}.bookings_pickers[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .search.dropdown[_ngcontent-%COMP%]   .default.text[_ngcontent-%COMP%]{font-size:12px;margin-right:0!important;padding:8px 0 0 38px!important}.user-table-list.b2c-list-user-table[_ngcontent-%COMP%]{margin-top:16px}.tab.segment[_ngcontent-%COMP%]{box-shadow:3px 3px 4px 0 rgba(0,0,0,.4)}.ui.top.attached.tabular.menu[_ngcontent-%COMP%]{margin-top:25px}.ui.bottom.attached.active.tab.segment[_ngcontent-%COMP%]{border-bottom-left-radius:17px;border-bottom-right-radius:17px;border-top-right-radius:17px}.ui.top.attached.menu[_ngcontent-%COMP%] > .item[_ngcontent-%COMP%]{border-radius:.28571429rem 0 0 0;border-top-right-radius:15px!important}.ticket-report-header[_ngcontent-%COMP%]{position:relative;left:32%;color:rgba(0,0,0,.48);font-family:Roboto,sans-serif;font-weight:200}.b2c-list-user-table__segment-loader[_ngcontent-%COMP%]{height:450px;background-color:#fff!important;border:0;box-shadow:none}.b2c-list-user-table__segment-loader[_ngcontent-%COMP%]   .ui.inverted.dimmer[_ngcontent-%COMP%]{background-color:transparent!important}.b2c-list-user-table__segment-loader[_ngcontent-%COMP%]   .eye-icon[_ngcontent-%COMP%]{font-size:12px;color:#3867b1}.ui.form[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;font-style:normal;font-weight:500;font-size:13px;line-height:13px;color:#181b20;margin:0 0 8px}.eight.field.bookings_btn-panel[_ngcontent-%COMP%]{padding:0;text-align:right}.agent-name-booking[_ngcontent-%COMP%]{margin:auto 24px!important}.agent-name-booking[_ngcontent-%COMP%]   .eight.wide.field[_ngcontent-%COMP%]{padding:0}.agent-name-booking[_ngcontent-%COMP%]   .eight.wide.field[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:0}.five.wide.field[_ngcontent-%COMP%]{padding-bottom:16px}.ui.attached.segment.tabContent-block[_ngcontent-%COMP%]   .ui.segment[_ngcontent-%COMP%]   .report-form[_ngcontent-%COMP%]{padding:24px;margin-bottom:24px}.ui.attached.segment.tabContent-block[_ngcontent-%COMP%]   .ui.segment[_ngcontent-%COMP%]   .report-form[_ngcontent-%COMP%]   .fields[_ngcontent-%COMP%]:last-child{margin-bottom:0}.ui.attached.segment.tabContent-block[_ngcontent-%COMP%]   .ui.segment[_ngcontent-%COMP%]   .report-form[_ngcontent-%COMP%]   .fields[_ngcontent-%COMP%]:last-child   .five.wide.field[_ngcontent-%COMP%]{padding-bottom:0}.ui.top.attached.tabular.menu[_ngcontent-%COMP%]{margin:24px 0}.bookings_btn-panel[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 6px}"]}),D)}],F=((J=function t(){_classCallCheck(this,t)}).\u0275mod=a.Ob({type:J}),J.\u0275inj=a.Nb({factory:function(t){return new(t||J)},imports:[[p.j.forChild(I)],p.j]}),J);o.d(e,"TicketReportModule",(function(){return j}));var A,j=((A=function t(){_classCallCheck(this,t)}).\u0275mod=a.Ob({type:A}),A.\u0275inj=a.Nb({factory:function(t){return new(t||A)},providers:[b.a],imports:[[n.c,i.v,i.k,r.d,F]]}),A)}}]);