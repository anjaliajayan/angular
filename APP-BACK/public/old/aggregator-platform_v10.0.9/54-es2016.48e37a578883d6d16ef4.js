(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{NBuS:function(t,e,i){"use strict";i.r(e);var n=i("ofXK"),o=i("3Pt+"),r=i("fXoL"),a=i("8laU"),s=i("Iab2"),c=i("EUZL");let l=(()=>{class t{constructor(){}exportAsExcelFile(t,e){const i=c.utils.json_to_sheet(t);console.log("worksheet",i);const n=c.write({Sheets:{data:i},SheetNames:["data"]},{bookType:"xlsx",type:"array"});this.saveAsExcelFile(n,e)}saveAsExcelFile(t,e){const i=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});s.saveAs(i,e+"_export_"+(new Date).getTime()+".xlsx")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var d=i("5eHb"),b=i("tyNb");function p(t,e){if(1&t){const t=r.Xb();r.Wb(0,"form",11),r.Wb(1,"input",12),r.ec("ngModelChange",(function(e){return r.Ac(t),r.ic().available.picker=e}))("ngModelChange",(function(e){r.Ac(t);const i=r.ic();return i.onFilter(i.available)})),r.Vb(),r.Vb()}if(2&t){const t=r.ic();r.Cb(1),r.pc("ngModel",t.available.picker)}}const h=function(t,e){return{selected:t,disabled:e}};function g(t,e){if(1&t){const t=r.Xb();r.Wb(0,"li",13),r.ec("click",(function(i){r.Ac(t);const n=e.$implicit,o=e.index,a=r.ic();return!a.disabled&&a.selectItem(a.available.pick,n),a.shiftClick(i,o,a.available,n)}))("dragstart",(function(i){r.Ac(t);const n=e.$implicit,o=r.ic();return o.drag(i,n,o.available)}))("dragend",(function(e){r.Ac(t);const i=r.ic();return i.dragEnd(i.available)})),r.Wb(1,"label"),r.Jc(2),r.Vb(),r.Vb()}if(2&t){const t=e.$implicit,i=r.ic();r.pc("ngClass",r.vc(3,h,i.isItemSelected(i.available.pick,t),i.disabled))("draggable",!i.disabled&&i.format.draggable),r.Cb(2),r.Kc(t._name)}}function u(t,e){if(1&t){const t=r.Xb();r.Wb(0,"form",11),r.Wb(1,"input",14),r.ec("ngModelChange",(function(e){return r.Ac(t),r.ic().confirmed.picker=e}))("ngModelChange",(function(e){r.Ac(t);const i=r.ic();return i.onFilter(i.confirmed)})),r.Vb(),r.Vb()}if(2&t){const t=r.ic();r.Cb(1),r.pc("ngModel",t.confirmed.picker)}}function f(t,e){if(1&t){const t=r.Xb();r.Wb(0,"li",13,15),r.ec("click",(function(i){r.Ac(t);const n=e.$implicit,o=e.index,a=r.ic();return!a.disabled&&a.selectItem(a.confirmed.pick,n),a.shiftClick(i,o,a.confirmed,n)}))("dragstart",(function(i){r.Ac(t);const n=e.$implicit,o=r.ic();return o.drag(i,n,o.confirmed)}))("dragend",(function(e){r.Ac(t);const i=r.ic();return i.dragEnd(i.confirmed)})),r.Wb(2,"label"),r.Jc(3),r.Vb(),r.Vb()}if(2&t){const t=e.$implicit,i=r.ic();r.pc("ngClass",r.vc(3,h,i.isItemSelected(i.confirmed.pick,t),i.disabled))("draggable",!i.disabled&&i.format.draggable),r.Cb(3),r.Kc(t._name)}}const m=function(t,e){return{order:t,"margin-left":e}},v=function(t,e){return{"max-height":t,"min-height":e}},k=function(t){return{over:t}};class C{constructor(t){this._name=t,this.last=null,this.picker="",this.dragStart=!1,this.dragOver=!1,this.pick=[],this.list=[],this.sift=[]}get name(){return this._name}}var _=0;let O=(()=>{class t{constructor(e){this.differs=e,this.id=`dual-list-${_++}`,this.key="_id",this.display="_name",this.height="100px",this.filter=!1,this.format=t.DEFAULT_FORMAT,this.sort=!1,this.disabled=!1,this.destinationChange=new r.n,this.sorter=(t,e)=>t._name<e._name?-1:t._name>e._name?1:0,this.available=new C(t.AVAILABLE_LIST_NAME),this.confirmed=new C(t.CONFIRMED_LIST_NAME)}ngOnChanges(e){e.filter&&!1===e.filter.currentValue&&(this.clearFilter(this.available),this.clearFilter(this.confirmed)),e.sort&&(!0===e.sort.currentValue&&void 0===this.compare?this.compare=this.sorter:!1===e.sort.currentValue&&(this.compare=void 0)),e.format&&(this.format=e.format.currentValue,void 0===this.format.direction&&(this.format.direction=t.LTR),void 0===this.format.add&&(this.format.add=t.DEFAULT_FORMAT.add),void 0===this.format.remove&&(this.format.remove=t.DEFAULT_FORMAT.remove),void 0===this.format.all&&(this.format.all=t.DEFAULT_FORMAT.all),void 0===this.format.none&&(this.format.none=t.DEFAULT_FORMAT.none),void 0===this.format.draggable&&(this.format.draggable=t.DEFAULT_FORMAT.draggable)),e.source&&(this.available=new C(t.AVAILABLE_LIST_NAME),this.updatedSource(),this.updatedDestination()),e.destination&&(this.confirmed=new C(t.CONFIRMED_LIST_NAME),this.updatedDestination(),this.updatedSource())}ngDoCheck(){this.source&&this.buildAvailable(this.source)&&this.onFilter(this.available),this.destination&&this.buildConfirmed(this.destination)&&this.onFilter(this.confirmed)}buildAvailable(t){const e=this.sourceDiffer.diff(t);return!!e&&(e.forEachRemovedItem(t=>{const e=this.findItemIndex(this.available.list,t.item,this.key);-1!==e&&this.available.list.splice(e,1)}),e.forEachAddedItem(t=>{-1===this.findItemIndex(this.available.list,t.item,this.key)&&this.available.list.push({_id:this.makeId(t.item),_name:this.makeName(t.item)})}),void 0!==this.compare&&this.available.list.sort(this.compare),this.available.sift=this.available.list,!0)}buildConfirmed(t){let e=!1;const i=this.destinationDiffer.diff(t);return!!i&&(i.forEachRemovedItem(t=>{const i=this.findItemIndex(this.confirmed.list,t.item,this.key);-1!==i&&(this.isItemSelected(this.confirmed.pick,this.confirmed.list[i])||this.selectItem(this.confirmed.pick,this.confirmed.list[i]),this.moveItem(this.confirmed,this.available,this.confirmed.list[i],!1),e=!0)}),i.forEachAddedItem(t=>{const i=this.findItemIndex(this.available.list,t.item,this.key);-1!==i&&(this.isItemSelected(this.available.pick,this.available.list[i])||this.selectItem(this.available.pick,this.available.list[i]),this.moveItem(this.available,this.confirmed,this.available.list[i],!1),e=!0)}),void 0!==this.compare&&this.confirmed.list.sort(this.compare),this.confirmed.sift=this.confirmed.list,e&&this.trueUp(),!0)}updatedSource(){this.available.list.length=0,this.available.pick.length=0,void 0!==this.source&&(this.sourceDiffer=this.differs.find(this.source).create(null))}updatedDestination(){void 0!==this.destination&&(this.destinationDiffer=this.differs.find(this.destination).create(null))}direction(){return this.format.direction===t.LTR}dragEnd(t=null){return t?t.dragStart=!1:(this.available.dragStart=!1,this.confirmed.dragStart=!1),!1}drag(t,e,i){this.isItemSelected(i.pick,e)||this.selectItem(i.pick,e),i.dragStart=!0,t.dataTransfer.setData(this.id,e._id)}allowDrop(t,e){return t.dataTransfer.types.length&&t.dataTransfer.types[0]===this.id&&(t.preventDefault(),e.dragStart||(e.dragOver=!0)),!1}dragLeave(){this.available.dragOver=!1,this.confirmed.dragOver=!1}drop(t,e){t.dataTransfer.types.length&&t.dataTransfer.types[0]===this.id&&(t.preventDefault(),this.dragLeave(),this.dragEnd(),e===this.available?this.moveItem(this.available,this.confirmed):this.moveItem(this.confirmed,this.available))}trueUp(){let t=!1,e=this.destination.length;for(;(e-=1)>=0;)0===this.confirmed.list.filter(t=>"object"==typeof this.destination[e]?t._id===this.destination[e][this.key]:t._id===this.destination[e]).length&&(this.destination.splice(e,1),t=!0);for(let i=0,n=this.confirmed.list.length;i<n;i+=1){let e=this.destination.filter(t=>"object"==typeof t?t[this.key]===this.confirmed.list[i]._id:t===this.confirmed.list[i]._id);0===e.length&&(e=this.source.filter(t=>"object"==typeof t?t[this.key]===this.confirmed.list[i]._id:t===this.confirmed.list[i]._id),e.length>0&&(this.destination.push(e[0]),t=!0))}t&&this.destinationChange.emit(this.destination)}findItemIndex(t,e,i="_id"){let n=-1;return t.filter("object"==typeof e?function(o){return o._id===e[i]&&(n=t.indexOf(o),!0)}:function(i){return i._id===e&&(n=t.indexOf(i),!0)}),n}makeUnavailable(t,e){const i=t.list.indexOf(e);-1!==i&&t.list.splice(i,1)}moveItem(t,e,i=null,n=!0){let o=0,r=t.pick.length;for(i&&(o=t.list.indexOf(i),r=o+1);o<r;o+=1){let n=[];if(i){const e=this.findItemIndex(t.pick,i);-1!==e&&(n[0]=t.pick[e])}else n=t.list.filter(e=>e._id===t.pick[o]._id);1===n.length&&(0===e.list.filter(t=>t._id===n[0]._id).length&&e.list.push(n[0]),this.makeUnavailable(t,n[0]))}void 0!==this.compare&&e.list.sort(this.compare),t.pick.length=0,n&&this.trueUp(),setTimeout(()=>{this.onFilter(t),this.onFilter(e)},10)}isItemSelected(t,e){return t.filter(t=>Object.is(t,e)).length>0}shiftClick(t,e,i,n){if(t.shiftKey&&i.last&&!Object.is(n,i.last)){const t=i.sift.indexOf(i.last);if(e>t)for(let n=t+1;n<e;n+=1)this.selectItem(i.pick,i.sift[n]);else if(-1!==t)for(let n=e+1;n<t;n+=1)this.selectItem(i.pick,i.sift[n])}i.last=n}selectItem(t,e){const i=t.filter(t=>Object.is(t,e));if(i.length>0)for(let n=0,o=i.length;n<o;n+=1){const e=t.indexOf(i[n]);-1!==e&&t.splice(e,1)}else t.push(e)}selectAll(t){t.pick.length=0,t.pick=t.sift.slice(0)}selectNone(t){t.pick.length=0}isAllSelected(t){return 0===t.list.length||t.list.length===t.pick.length}isAnySelected(t){return t.pick.length>0}unpick(t){for(let e=t.pick.length-1;e>=0;e-=1)-1===t.sift.indexOf(t.pick[e])&&t.pick.splice(e,1)}clearFilter(t){t&&(t.picker="",this.onFilter(t))}onFilter(t){if(t.picker.length>0)try{const e=t.list.filter(e=>"[object Object]"===Object.prototype.toString.call(e)?void 0!==e._name?-1!==e._name.toLocaleLowerCase(this.format.locale).indexOf(t.picker.toLocaleLowerCase(this.format.locale)):-1!==JSON.stringify(e).toLocaleLowerCase(this.format.locale).indexOf(t.picker.toLocaleLowerCase(this.format.locale)):-1!==e.toLocaleLowerCase(this.format.locale).indexOf(t.picker.toLocaleLowerCase(this.format.locale)));t.sift=e,this.unpick(t)}catch(e){e instanceof RangeError&&(this.format.locale=void 0),t.sift=t.list}else t.sift=t.list}makeId(t){return"object"==typeof t?t[this.key]:t}makeName(t,e="_"){const i=this.display;function n(t){switch(Object.prototype.toString.call(t)){case"[object Number]":case"[object String]":return t;default:return void 0!==t?t[i]:"undefined"}}let o="";if(void 0!==this.display)switch(Object.prototype.toString.call(this.display)){case"[object Function]":o=this.display(t);break;case"[object Array]":for(let i=0,n=this.display.length;i<n;i+=1)if(o.length>0&&(o+=e),-1===this.display[i].indexOf("."))o+=t[this.display[i]];else{const e=this.display[i].split("."),n=t[e[0]];if(n)if(-1!==e[1].indexOf("substring")){const t=e[1].substring(e[1].indexOf("(")+1,e[1].indexOf(")")).split(",");switch(t.length){case 1:o+=n.substring(parseInt(t[0],10));break;case 2:o+=n.substring(parseInt(t[0],10),parseInt(t[1],10));break;default:o+=n}}else o+=n}break;default:o=n(t)}else o=n(t);return o}}return t.\u0275fac=function(e){return new(e||t)(r.Qb(r.s))},t.\u0275cmp=r.Kb({type:t,selectors:[["dual-list"]],inputs:{id:"id",key:"key",display:"display",height:"height",filter:"filter",format:"format",sort:"sort",disabled:"disabled",compare:"compare",source:"source",destination:"destination"},outputs:{destinationChange:"destinationChange"},features:[r.Ab()],decls:25,vars:40,consts:[[1,"dual-list"],[1,"listbox",3,"ngStyle"],["type","button","name","addBtn",1,"btn","btn-primary","btn-block",3,"ngClass","disabled","click"],["class","filter",4,"ngIf"],[1,"record-picker"],[3,"ngStyle","ngClass","drop","dragover","dragleave"],[3,"ngClass","draggable","click","dragstart","dragend",4,"ngFor","ngForOf"],[1,"button-bar"],["type","button",1,"btn","btn-primary","pull-left",3,"disabled","click"],["type","button",1,"btn","btn-default","pull-right",3,"disabled","click"],["type","button","name","removeBtn",1,"btn","btn-primary","btn-block",3,"ngClass","disabled","click"],[1,"filter"],["name","filterSource",1,"form-control",3,"ngModel","ngModelChange"],[3,"ngClass","draggable","click","dragstart","dragend"],["name","filterDestination",1,"form-control",3,"ngModel","ngModelChange"],["itmConf",""]],template:function(t,e){1&t&&(r.Wb(0,"div",0),r.Wb(1,"div",1),r.Wb(2,"button",2),r.ec("click",(function(t){return e.moveItem(e.available,e.confirmed)})),r.Jc(3),r.Vb(),r.Hc(4,p,2,1,"form",3),r.Wb(5,"div",4),r.Wb(6,"ul",5),r.ec("drop",(function(t){return e.drop(t,e.confirmed)}))("dragover",(function(t){return e.allowDrop(t,e.available)}))("dragleave",(function(t){return e.dragLeave()})),r.Hc(7,g,3,6,"li",6),r.Vb(),r.Vb(),r.Wb(8,"div",7),r.Wb(9,"button",8),r.ec("click",(function(t){return e.selectAll(e.available)})),r.Jc(10),r.Vb(),r.Wb(11,"button",9),r.ec("click",(function(t){return e.selectNone(e.available)})),r.Jc(12),r.Vb(),r.Vb(),r.Vb(),r.Wb(13,"div",1),r.Wb(14,"button",10),r.ec("click",(function(t){return e.moveItem(e.confirmed,e.available)})),r.Jc(15),r.Vb(),r.Hc(16,u,2,1,"form",3),r.Wb(17,"div",4),r.Wb(18,"ul",5),r.ec("drop",(function(t){return e.drop(t,e.available)}))("dragover",(function(t){return e.allowDrop(t,e.confirmed)}))("dragleave",(function(t){return e.dragLeave()})),r.Hc(19,f,4,6,"li",6),r.Vb(),r.Vb(),r.Wb(20,"div",7),r.Wb(21,"button",8),r.ec("click",(function(t){return e.selectAll(e.confirmed)})),r.Jc(22),r.Vb(),r.Wb(23,"button",9),r.ec("click",(function(t){return e.selectNone(e.confirmed)})),r.Jc(24),r.Vb(),r.Vb(),r.Vb(),r.Vb()),2&t&&(r.Cb(1),r.pc("ngStyle",r.vc(24,m,e.direction()?1:2,e.direction()?0:"10px")),r.Cb(1),r.pc("ngClass",e.direction()?"point-right":"point-left")("disabled",0===e.available.pick.length),r.Cb(1),r.Kc(e.format.add),r.Cb(1),r.pc("ngIf",e.filter),r.Cb(2),r.pc("ngStyle",r.vc(27,v,e.height,e.height))("ngClass",r.uc(30,k,e.available.dragOver)),r.Cb(1),r.pc("ngForOf",e.available.sift),r.Cb(2),r.pc("disabled",e.disabled||e.isAllSelected(e.available)),r.Cb(1),r.Kc(e.format.all),r.Cb(1),r.pc("disabled",!e.isAnySelected(e.available)),r.Cb(1),r.Kc(e.format.none),r.Cb(1),r.pc("ngStyle",r.vc(32,m,e.direction()?2:1,e.direction()?"10px":0)),r.Cb(1),r.pc("ngClass",e.direction()?"point-left":"point-right")("disabled",0===e.confirmed.pick.length),r.Cb(1),r.Kc(e.format.remove),r.Cb(1),r.pc("ngIf",e.filter),r.Cb(2),r.pc("ngStyle",r.vc(35,v,e.height,e.height))("ngClass",r.uc(38,k,e.confirmed.dragOver)),r.Cb(1),r.pc("ngForOf",e.confirmed.sift),r.Cb(2),r.pc("disabled",e.disabled||e.isAllSelected(e.confirmed)),r.Cb(1),r.Kc(e.format.all),r.Cb(1),r.pc("disabled",!e.isAnySelected(e.confirmed)),r.Cb(1),r.Kc(e.format.none))},directives:[n.q,n.n,n.p,n.o,o.B,o.p,o.q,o.c,o.o,o.r],styles:['div.record-picker[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:auto;border:1px solid #ddd;border-radius:8px;position:relative;cursor:pointer;scrollbar-base-color:#337ab7;scrollbar-3dlight-color:#337ab7;scrollbar-highlight-color:#337ab7;scrollbar-track-color:#eee;scrollbar-arrow-color:gray;scrollbar-shadow-color:gray;scrollbar-dark-shadow-color:gray}div.record-picker[_ngcontent-%COMP%]::-webkit-scrollbar{width:12px}div.record-picker[_ngcontent-%COMP%]::-webkit-scrollbar-button{width:0;height:0}div.record-picker[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#eee;box-shadow:0 0 3px #dfdfdf inset;border-top-right-radius:8px;border-bottom-right-radius:8px}div.record-picker[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#337ab7;border:thin solid gray;border-top-right-radius:8px;border-bottom-right-radius:8px}div.record-picker[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#286090}.record-picker[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding:0 0 1px}.record-picker[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{border-top:thin solid #ddd;border-bottom:1px solid #ddd;display:block;padding:2px 2px 2px 10px;margin-bottom:-1px;font-size:.85em;cursor:pointer;white-space:nowrap;min-height:16px}.record-picker[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.record-picker[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%]{background-color:#d9edf7}.record-picker[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%]:hover{background-color:#c4e3f3}.record-picker[_ngcontent-%COMP%]   li.disabled[_ngcontent-%COMP%]{opacity:.5;cursor:default;background-color:inherit}.record-picker[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child{border-top-left-radius:8px;border-top-right-radius:8px;border-top:none}.record-picker[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{border-bottom-left-radius:8px;border-bottom-right-radius:8px;border-bottom:none}.record-picker[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;font-weight:inherit;font-size:14px;padding:4px;margin-bottom:-1px;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.record-picker[_ngcontent-%COMP%]   ul.over[_ngcontent-%COMP%]{background-color:#d3d3d3}.dual-list[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-content:flex-start}.dual-list[_ngcontent-%COMP%]   .listbox[_ngcontent-%COMP%]{width:50%;margin:0}.dual-list[_ngcontent-%COMP%]   .button-bar[_ngcontent-%COMP%]{margin-top:8px}.point-right[_ngcontent-%COMP%]::after{content:"\\25B6";padding-left:1em}.point-left[_ngcontent-%COMP%]::before{content:"\\25C0";padding-right:1em}.dual-list[_ngcontent-%COMP%]   .button-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:47%}button.btn-block[_ngcontent-%COMP%]{display:block;width:100%;margin-bottom:8px}.filter[_ngcontent-%COMP%]{margin-bottom:-2.2em}.filter[_ngcontent-%COMP%]::after{content:"o";width:40px;color:transparent;font-size:2em;background-image:url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M0 64l192 192v192l128-32V256L512 64H0z"/></svg>\');background-repeat:no-repeat;background-position:center center;opacity:.2;top:-36px;left:calc(100% - 21px);position:relative}']}),t.AVAILABLE_LIST_NAME="available",t.CONFIRMED_LIST_NAME="confirmed",t.LTR="left-to-right",t.RTL="right-to-left",t.DEFAULT_FORMAT={add:"Add",remove:"Remove",all:"All",none:"None",direction:t.LTR,draggable:!0,locale:void 0},t})(),x=(()=>{class t{}return t.\u0275mod=r.Ob({type:t}),t.\u0275inj=r.Nb({factory:function(e){return new(e||t)},imports:[[n.c,o.k]]}),t})();function y(t,e){if(1&t){const t=r.Xb();r.Wb(0,"div"),r.Wb(1,"div",42),r.Wb(2,"dual-list",43),r.ec("destinationChange",(function(e){return r.Ac(t),r.ic().confirmed=e})),r.Vb(),r.Vb(),r.Vb()}if(2&t){const t=r.ic();r.Cb(2),r.pc("source",t.source)("destination",t.confirmed)}}function M(t,e){if(1&t){const t=r.Xb();r.Wb(0,"button",48),r.ec("click",(function(e){return r.Ac(t),r.ic(2).exportPivotData()})),r.Jc(1," Export "),r.Vb()}}function w(t,e){if(1&t&&(r.Wb(0,"div",44),r.Wb(1,"div",45),r.Jc(2,"Dynamic Report"),r.Vb(),r.Wb(3,"div",46),r.Hc(4,M,2,0,"button",47),r.Vb(),r.Vb()),2&t){const t=r.ic();r.Cb(4),r.pc("ngIf",t.showExportButton)}}const P=function(t){return{error:t}},V=[{path:"",component:(()=>{class t{constructor(t,e,i,n){this.fb=t,this.ReportService=e,this.exportReportService=i,this.toastr=n,this.selectedReports=[],this.choosedOrganisation=[],this.showChooseOrg=!1,this.showExportButton=!1,this.submitted=!1,this.newOrganiseObj={},this.source=[],this.confirmed=[],this.newDynamicReportObj={},this.showReportResults=[],this.bookingsLoader=!1,this.dynamicReportForm=this.fb.group({reportBy:["",[o.z.required]],reportType:[""],selectedOrg:[""],reportStartDate:["",[o.z.required]],reportEndDate:["",[o.z.required]]}),this.loadStartDate=()=>{var t=this;$((function(){$('input[name="reportStartDate"]').daterangepicker({singleDatePicker:!0,showDropdowns:!0,minYear:1901,startDate:moment().subtract(90,"day"),autoUpdateInput:!1},(function(e,i,n){moment().diff(e,"years"),t.dynamicReportForm.get("reportStartDate").setValue(moment(e).format("DD-MM-YYYY"))}))}))},this.loadEndDate=()=>{var t=this;$((function(){$('input[name="reportEndDate"]').daterangepicker({singleDatePicker:!0,showDropdowns:!0,minYear:1901,startDate:moment(),autoUpdateInput:!1},(function(e,i,n){moment().diff(e,"years"),t.dynamicReportForm.get("reportEndDate").setValue(moment(e).format("DD-MM-YYYY"))}))}))},this.setReportType=t=>{this.dynamicReportForm.get("reportType").setValue(t)},this.setReportBy=t=>{"option"==t?this.showChooseOrg=!1:(this.showChooseOrg=!0,this.fetchAllOrganization()),this.dynamicReportForm.get("reportBy").setValue(t)},this.showReport=()=>{this.bookingsLoader=!0,this.submitted=!0,this.dynamicReportForm.invalid||(this.newDynamicReportObj.start_date=this.dynamicReportForm.get("reportStartDate").value,this.newDynamicReportObj.end_date=this.dynamicReportForm.get("reportEndDate").value,this.dynamicReportForm.get("selectedOrg").setValue(this.confirmed),this.dynamicReportForm.get("selectedOrg").setValue(this.MapNametoIds(this.confirmed)),this.newDynamicReportObj.organisation_ids=this.dynamicReportForm.get("selectedOrg").value,this.ReportService.NewDynamicPivotTable(this.newDynamicReportObj).subscribe(t=>{"result"==t.type?(this.bookingsLoader=!1,0!=t.Output.length?this.showReportResults=t.Output:this.toastr.info("There is no data available to show","Oops!!",{timeOut:3e3,progressBar:!1,positionClass:"toast-bottom-right"}),this.pivotTable()):(this.bookingsLoader=!1,this.toastr.error(`${t.msg}`,`${t.msg}`,{timeOut:1e4,progressBar:!1,positionClass:"toast-bottom-right"}))}))},this.exportPivotData=()=>{var t=new Date,e=t.getFullYear()+"_"+(t.getMonth()+1)+"_"+t.getDate();$("#output").table2excel({exclude:".noExl",name:"Report ",filename:"CustomReport"+e})}}get f(){return this.dynamicReportForm.controls}ngOnInit(){}ngAfterViewInit(){$(document).ready((function(){$(".menu .item").tab(),$(".ui.dropdown").dropdown()})),this.loadEndDate(),this.loadStartDate()}fetchAllOrganization(){this.ReportService.GetAllOrganization().subscribe(t=>{t.status?(t.result.data.forEach(t=>{null!=t.name&&this.source.push(t.name)}),this.orginalOrganisationsResult=t.result.data):this.toastr.error(`${t.message}`,"",{timeOut:1e3,progressBar:!1,positionClass:"toast-bottom-right"})})}pivotTable(){this.showExportButton=!0,$.pivotUtilities.tipsData=this.showReportResults;var t=$.extend($.pivotUtilities.renderers,$.pivotUtilities.plotly_renderers);$,$("#output").pivotUI($.pivotUtilities.tipsData,{renderers:t})}MapNametoIds(t){var e=this.orginalOrganisationsResult,i=[];for(let o=0;o<t.length;o++){const r=t[o];var n=e.filter(t=>t.name==r);n.length>=0&&i.push(n[0].parent_id)}return i}}return t.\u0275fac=function(e){return new(e||t)(r.Qb(o.f),r.Qb(a.a),r.Qb(l),r.Qb(d.b))},t.\u0275cmp=r.Kb({type:t,selectors:[["app-dynamic-report"]],decls:82,vars:12,consts:[[1,"ui","top","attached","tabular","menu"],["data-tab","first","routerLink","/report/booking-report",1,"item"],["data-tab","second","routerLink","/report/segment-report",1,"item"],["data-tab","third","routerLink","/report/mis-report",1,"item"],["data-tab","fourth","routerLink","/report/search-log-report",1,"item"],["data-tab","fifth","routerLink","/report/audit-report",1,"item"],["data-tab","sixth","routerLink","/report/ticket-report",1,"item"],["data-tab","seventh","routerLink","/report/dynamic-report",1,"item","active"],["data-tab","seventh",1,"ui","bottom","attached","tab","segment","tabContent-block","active"],[1,"ui","fluid","container"],[1,"box-container"],[1,"ui","one","column","grid"],[1,"column"],[1,"ui","form",3,"formGroup","ngSubmit"],[1,"ui","segment"],[1,""],[1,"result-block"],[1,"ui","small","header"],[1,"ui","divider"],[1,"field"],[1,"fields"],[1,"six","wide","field","dual-choose",3,"ngClass"],[1,"mandatory"],[1,"ui","fluid","search","selection","dropdown"],["type","hidden","formControlName","reportBy","name","reportBy","value","","required",""],[1,"dropdown","icon"],[1,"default","text"],[1,"menu"],[1,"item",3,"click"],[1,"six","wide","field","dual-choose"],["type","hidden","formControlName","reportType","name","reportType","value",""],[4,"ngIf"],[1,"six","wide","field","bookings_pickers",3,"ngClass"],[1,"ui","left","icon","input"],["type","text","placeholder","Start Date","formControlName","reportStartDate","name","reportStartDate","value","","required",""],[1,"icon"],["src","./../../../../assets/icons/calendar.svg",1,"bookings_input__placeholder-icon","cal"],["type","text","placeholder","End Date","formControlName","reportEndDate","name","reportEndDate","value","","required",""],[1,"sixteen","wide","field","bookings_btn-panel"],[1,"ui","primary","button"],["class","fields agent-name-booking",4,"ngIf"],["id","output",1,"output-pivot"],[1,"dual-list-choose-org"],[3,"source","destination","destinationChange"],[1,"fields","agent-name-booking"],[1,"eight","wide","field","ui","small","header"],[1,"eight","wide","field","bookings_btn-panel"],["class","ui export button","title","Export",3,"click",4,"ngIf"],["title","Export",1,"ui","export","button",3,"click"]],template:function(t,e){1&t&&(r.Wb(0,"div",0),r.Wb(1,"div",1),r.Jc(2," Booking "),r.Vb(),r.Wb(3,"div",2),r.Jc(4,"Segment"),r.Vb(),r.Wb(5,"div",3),r.Jc(6,"MIS"),r.Vb(),r.Wb(7,"div",4),r.Jc(8,"Search Log"),r.Vb(),r.Wb(9,"div",5),r.Jc(10,"Audit Trail Log"),r.Vb(),r.Wb(11,"div",6),r.Jc(12,"Ticket"),r.Vb(),r.Wb(13,"div",7),r.Jc(14,"Dynamic Report"),r.Vb(),r.Vb(),r.Wb(15,"div",8),r.Wb(16,"div",9),r.Wb(17,"div",10),r.Wb(18,"div",11),r.Wb(19,"div",12),r.Wb(20,"form",13),r.ec("ngSubmit",(function(t){return e.showReport()})),r.Wb(21,"div",14),r.Wb(22,"div",15),r.Wb(23,"div",16),r.Wb(24,"div",17),r.Jc(25,"Choose Parameters"),r.Vb(),r.Rb(26,"div",18),r.Wb(27,"div",19),r.Wb(28,"div",20),r.Wb(29,"div",21),r.Wb(30,"label"),r.Jc(31,"Report By "),r.Wb(32,"span",22),r.Jc(33,"*"),r.Vb(),r.Vb(),r.Wb(34,"div",23),r.Rb(35,"input",24),r.Rb(36,"i",25),r.Wb(37,"div",26),r.Jc(38,"Report By"),r.Vb(),r.Wb(39,"div",27),r.Wb(40,"div",28),r.ec("click",(function(t){return e.setReportBy("organisation")})),r.Jc(41,"Organisation"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(42,"div",29),r.Wb(43,"label"),r.Jc(44,"Report Type"),r.Vb(),r.Wb(45,"div",23),r.Rb(46,"input",30),r.Rb(47,"i",25),r.Wb(48,"div",26),r.Jc(49,"Report Type"),r.Vb(),r.Wb(50,"div",27),r.Wb(51,"div",28),r.ec("click",(function(t){return e.setReportType("filghtBooking")})),r.Jc(52,"Filght|Detail Booking"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Hc(53,y,3,2,"div",31),r.Rb(54,"br"),r.Wb(55,"div",19),r.Wb(56,"div",20),r.Wb(57,"div",32),r.Wb(58,"label"),r.Jc(59,"Start Date"),r.Wb(60,"span",22),r.Jc(61,"*"),r.Vb(),r.Vb(),r.Wb(62,"div",33),r.Rb(63,"input",34),r.Wb(64,"i",35),r.Rb(65,"img",36),r.Vb(),r.Vb(),r.Vb(),r.Wb(66,"div",32),r.Wb(67,"label"),r.Jc(68,"End Date"),r.Wb(69,"span",22),r.Jc(70,"*"),r.Vb(),r.Vb(),r.Wb(71,"div",33),r.Rb(72,"input",37),r.Wb(73,"i",35),r.Rb(74,"img",36),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(75,"div",19),r.Wb(76,"div",20),r.Wb(77,"div",38),r.Wb(78,"button",39),r.Jc(79," Show Report "),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Hc(80,w,5,1,"div",40),r.Rb(81,"div",41),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb()),2&t&&(r.Cb(20),r.pc("formGroup",e.dynamicReportForm),r.Cb(9),r.pc("ngClass",r.uc(6,P,e.submitted&&e.f.reportBy.errors&&e.f.reportBy.errors.required)),r.Cb(24),r.pc("ngIf",e.showChooseOrg),r.Cb(4),r.pc("ngClass",r.uc(8,P,e.submitted&&e.f.reportStartDate.errors&&e.f.reportStartDate.errors.required)),r.Cb(9),r.pc("ngClass",r.uc(10,P,e.submitted&&e.f.reportEndDate.errors&&e.f.reportEndDate.errors.required)),r.Cb(14),r.pc("ngIf",e.showExportButton))},directives:[b.g,o.B,o.p,o.i,n.n,o.c,o.o,o.h,o.w,n.p,O],styles:[".bookings_btn-panel[_ngcontent-%COMP%]{padding:20px 2px 0;text-align:right}.bookings_pickers[_ngcontent-%COMP%]   .input.bookings_datepicker[_ngcontent-%COMP%]{min-width:120px;max-width:138px}.bookings_pickers[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .ui.basic.floating.button[_ngcontent-%COMP%]{padding:10px!important;color:hsla(0,0%,59.6%,.6)!important;font-weight:300!important;line-height:11px}.bookings_pickers[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{opacity:1;z-index:100}.bookings_pickers[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .bookings_input__placeholder-icon[_ngcontent-%COMP%]{width:24px;margin-top:6px}.bookings_pickers[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .bookings_input__placeholder-icon.cal[_ngcontent-%COMP%]{width:18px;margin-top:10px}.bookings_pickers[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .search.dropdown[_ngcontent-%COMP%]{width:218px;border-right:0;border-top-left-radius:5px;border-bottom-left-radius:5px}.bookings_pickers[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .search.dropdown[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{margin-left:42px!important}.bookings_pickers[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .search.dropdown[_ngcontent-%COMP%]   .default.text[_ngcontent-%COMP%]{font-size:12px;margin-right:0!important;padding:8px 0 0 38px!important}.corporate_input__placeholder-icon[_ngcontent-%COMP%]{position:relative;width:18px;bottom:28px;left:9px}table[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;border-collapse:collapse;width:50%;margin-left:300px}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{border:1px solid #ddd;text-align:left;padding:8px}th[_ngcontent-%COMP%]{padding:20px}.minimise-icon[_ngcontent-%COMP%]{float:right}mat-selection-list[_ngcontent-%COMP%]{max-height:200px;overflow:auto}.main_report-org__scroll[_ngcontent-%COMP%], mat-selection-list[_ngcontent-%COMP%]{width:100%;max-width:300px;border:1px solid rgba(0,0,0,.11)}.add-arrow-icon[_ngcontent-%COMP%]{position:relative;padding:31px;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.dual-list-choose-org[_ngcontent-%COMP%]{padding-top:20px;width:75%;margin:0 auto 20px}.seven.wide.field.dual-choose[_ngcontent-%COMP%]{margin-bottom:20px}.output-pivot[_ngcontent-%COMP%]{margin-top:30px;max-width:100%;overflow-x:auto}.tab.segment[_ngcontent-%COMP%]{box-shadow:3px 3px 4px 0 rgba(0,0,0,.4)}.ui.top.attached.tabular.menu[_ngcontent-%COMP%]{margin-top:25px}.ui.bottom.attached.active.tab.segment[_ngcontent-%COMP%]{border-bottom-left-radius:17px;border-bottom-right-radius:17px;border-top-right-radius:17px}.ui.top.attached.menu[_ngcontent-%COMP%] > .item[_ngcontent-%COMP%]{border-radius:.28571429rem 0 0 0;border-top-right-radius:15px!important}.dynamic-report-header[_ngcontent-%COMP%]{position:relative;left:32%;color:rgba(0,0,0,.48);font-family:Roboto,sans-serif;font-weight:200}.ui.form[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;font-style:normal;font-weight:500;font-size:13px;line-height:13px;color:#181b20;margin:0 0 8px}.ui.form[_ngcontent-%COMP%]   .three.wide.field[_ngcontent-%COMP%]{margin-bottom:16px}.ui.divider[_ngcontent-%COMP%]{margin-bottom:30px}.fields[_ngcontent-%COMP%]{-webkit-box-pack:center;justify-content:center}.output-pivot[_ngcontent-%COMP%]{width:auto;margin:32px}.output-pivot[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{background:#fff;padding:30px 40px;box-shadow:0 2px 6px rgba(6,40,98,.1)!important;border-radius:4.96141px}.agent-name-booking[_ngcontent-%COMP%]{margin:auto 32px!important}.agent-name-booking[_ngcontent-%COMP%]   .eight.wide.field[_ngcontent-%COMP%]{padding:0}.agent-name-booking[_ngcontent-%COMP%]   .eight.wide.field[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:0}.eight.field.bookings_btn-panel[_ngcontent-%COMP%]{padding:0;text-align:right}@media(max-width:1440px){.result-block[_ngcontent-%COMP%]{width:auto;margin:24px}}@media(max-width:1280px){.result-block[_ngcontent-%COMP%]{width:auto;margin:20px}}"]}),t})()}];let R=(()=>{class t{}return t.\u0275mod=r.Ob({type:t}),t.\u0275inj=r.Nb({factory:function(e){return new(e||t)},imports:[[b.j.forChild(V)],b.j]}),t})();i.d(e,"DynamicReportModule",(function(){return W}));let W=(()=>{class t{}return t.\u0275mod=r.Ob({type:t}),t.\u0275inj=r.Nb({factory:function(e){return new(e||t)},imports:[[n.c,o.v,o.k,R,x]]}),t})()}}]);