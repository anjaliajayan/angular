<div class="ui top attached tabular menu ">
    <!-- <div *appCanAccess="['reports', 'bookingRep','']" class="item active" data-tab="first" -->
    <div class="item active" data-tab="first" routerLink="/report/booking-report">
        Booking
    </div>
    <!-- <div *appCanAccess="['reports', 'segment','']" class="item" data-tab="second" routerLink="/report/segment-report"> -->
    <div class="item" data-tab="second" routerLink="/report/segment-report">
        Segment</div>
    <!-- <div *appCanAccess="['reports', 'mis','']" class="item" data-tab="third" routerLink="/report/mis-report">MIS</div> -->
    <div class="item" data-tab="third" routerLink="/report/mis-report">MIS</div>
    <!--   
  <div *appCanAccess="['reports', 'searchLog','']" class="item" data-tab="fourth"routerLink="/report/search-log-report">Search Log</div> -->
    <div class="item" data-tab="fourth" routerLink="/report/search-log-report">Search Log</div>
    <!-- <div *appCanAccess="['reports', 'auditTrial','']" class="item" data-tab="fifth" routerLink="/report/audit-report">Audit Trail Log</div> -->
    <div class="item" data-tab="fifth" routerLink="/report/audit-report">Audit Trail Log</div>
    <!-- <div *appCanAccess="['reports', 'ticket','']" class="item" data-tab="sixth" routerLink="/report/ticket-report">Ticket
  </div> -->
    <div class="item" data-tab="sixth" routerLink="/report/ticket-report">Ticket
    </div>
    <!-- <div *appCanAccess="['reports', 'dynamicReport','']" class="item" data-tab="seventh"
    routerLink="/report/dynamic-report">Dynamic Report</div> -->
    <div class="item" data-tab="seventh" routerLink="/report/dynamic-report">Dynamic Report</div>
</div>
<div class="ui bottom attached tab segment active tabContent-block" data-tab="first">
    <div class="ui segment">
        <div class="ui fluid container">
            <div class="outer-forms booking">
                <form [formGroup]="bookingReportForm" (ngSubmit)="viewReport()" class="ui form report-form">
                    <div class="field">
                        <div class="fields">
                            <!-- <div class="one wide field"></div> -->
                            <div class="six wide field">
                                <label>Choose Agent</label>
                                <select class="ui fluid search dropdownOne multiple_search" formControlName="selectAgent" multiple="">
                                  <option class="item" *ngFor="let agent of agents" value="{{agent.agent_code}}">{{agent.name}}</option>
                                </select>
                            </div>
                            <!--future use-->
                            <!-- <div class="four wide field">
                              <select class="ui fluid search dropdown" formControlName="selectProduct">
                                <option value="">Choose Products</option>
                                <option class="item" *ngFor="let product of products" value="{{product}}">{{product}}</option>
                              </select>
                            </div> -->

                            <div class="five wide field" [ngClass]="{'error': ((submitted && f.selectProduct.errors) && f.selectProduct.errors.required) }">
                                <label>Choose Product<span class="mandatory">*</span></label>
                                <select class="ui fluid search dropdown" formControlName="selectProduct" required>
                                  <option value="">Choose Product</option>
                                  <option class="item" value="flights">Flights</option>
                                  <option class="item" value="cars">Cars</option>
                                  <option class="item" value="hotel">Hotel</option>
                                  <option class="item" value="insurance">Insurance</option>
                                  <option class="item" value="transfer">Transfer</option>
                                  <option class="item" value="activity">Activity</option>
                                  <!-- <option class="item" value="cruises">cruises</option> -->
                         
                                </select>
                            </div>
                            <div class="five wide field">
                                <label>Choose Supplier</label>
                                <select class="ui fluid search dropdown" formControlName="selectSupplier">
                                  <!-- <option value="">Choose Supplier</option> -->
                                  <option value="" selected disabled>Choose Supplier</option>
                                  <option class="item" *ngFor="let supplier of suppliers" value="{{supplier.supplier_id}}">
                                    {{supplier.name}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="fields last-field">
                            <!-- <div class="one wide field"></div> -->
                            <div class="six wide field bookings_pickers " [ngClass]="{'error': ((submitted && f.bookingStartDate.errors) && f.bookingStartDate.errors.required) }">
                                <label>Start Date<span class="mandatory">*</span></label>
                                <div class="ui left icon input">
                                    <input type="text" placeholder="Start Date" formControlName="bookingStartDate" name="bookingStartDate" value="" required />
                                    <i class="icon">
                                        <i class="fa fa-calendar-o bookings_input__placeholder-icon cal" aria-hidden="true"></i>
                                        <!-- <img src="./../../../../assets/icons/calendar.svg" class="bookings_input__placeholder-icon cal" /> -->
                                    </i>
                                </div>
                            </div>
                            <div class="five wide field bookings_pickers" [ngClass]="{'error': ((submitted && f.bookingEndDate.errors) && f.bookingEndDate.errors.required) }">
                                <label>End Date<span class="mandatory">*</span></label>
                                <div class="ui left icon input">
                                    <input type="text" placeholder="End Date" formControlName="bookingEndDate" name="bookingEndDate" value="" required />
                                    <i class="icon">
                                        <!-- <img src="./../../../../assets/icons/calendar.svg" class="bookings_input__placeholder-icon cal" /> -->
                                        <i class="fa fa-calendar-o bookings_input__placeholder-icon cal" aria-hidden="true"></i>
                                    </i>
                                </div>
                            </div>
                            <div class="five wide field btn-wrapper">
                                <div class="bookings_btn-panel">
                                    <button class="ui primary reset button" (click)="resetReport()" title="Reset">
                                        <i class="undo icon"></i>
                                    </button>
                                    <button class="ui primary button">
                                        View Report
                                    </button>
                                    <!-- <div class="download-img" title="Export" (click)="exportData()">
                                        <img class="ui image download-img_icon" src="./../../../../assets/img/download.png" />
                                    </div> -->
                                </div>
                            </div>
                        </div>
                        <!-- <div class="fields btn-field">
                            <div class="bookings_btn-panel">
                                <button class="ui primary reset button" (click)="resetReport()" title="Reset">
                                  <i class="undo icon"></i>
                                </button>
                                <button class="ui primary button">
                                  View Report
                                </button>
                                <div class="download-img" title="Export" (click)="exportData()" *ngIf="showDynamicReport">
                                    <img class="ui image download-img_icon" src="./../../../../assets/img/download.png" />
                                </div>
                            </div>
                        </div> -->
                    </div>
                </form>
                <div class="ui segment b2c-list-user-table__segment-loader" *ngIf="bookingsLoader">
                    <div class="ui active inverted dimmer">
                        <div class="ui text loader">Loading Report ...</div>
                    </div>
                    <p></p>
                </div>
                <ng-container *ngFor="let booking of allBookings; let index = i;">
                    <ng-container *ngIf="booking.bookings.length">
                        <div *ngIf="showDynamicReport" class="fields agent-name-booking">
                            <!-- <p>{{booking.name}}</p> -->
                            <div class="eight wide field ui small header">{{booking.name}}</div>
                            <!-- <div class="ui divider"></div> -->
                            <div class="eight wide field bookings_btn-panel">
                                <button class="ui export button" (click)="exportData()" *ngIf="showDynamicReport" title="Export">
                                    Export
                                </button>
                            </div>
                        </div>
                        <div class="result-block">
                            <div class="user-table-list b2c-list-user-table" *ngIf="showDynamicReport">
                                <ngx-datatable #table{i} class='table' [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50" [rowHeight]="'auto'" [limit]="10" [rows]='booking.bookings' [sortType]="'multi'" [reorderable]="true" [sorts]="[{prop: 'id', dir: 'desc'}]">
                                    <ngx-datatable-column name="Product">
                                        <ng-template let-row="row" ngx-datatable-cell-template>
                                            <div *ngIf="row.has_flight == 1">Flights</div>
                                        </ng-template>
                                    </ngx-datatable-column>
                                    <ngx-datatable-column name="Agent Code" prop="agent_code">
                                    </ngx-datatable-column>
                                    <ngx-datatable-column name="Trip ID">
                                        <ng-template let-row="row" ngx-datatable-cell-template>
                                            <div (click)="getBookingRefereceDetails(row,'custom-modal-booking')"><a>{{row.trip_id}}</a></div>
                                        </ng-template>
                                    </ngx-datatable-column>
                                    <ngx-datatable-column name="Supplier" prop="suppliers">
                                    </ngx-datatable-column>
                                    <ngx-datatable-column name="Supplier Conf No" prop="pnr_no">
                                    </ngx-datatable-column>
                                    <ngx-datatable-column name="Supplier Amount">
                                        <ng-template let-row="row" ngx-datatable-cell-template>
                                            {{row.supplier_price |number : '1.2-2'}}         
                                    </ng-template>
                                    </ngx-datatable-column>
                                    <ngx-datatable-column name="Commission Amount">
                                        <ng-template let-row="row" ngx-datatable-cell-template>
                                            <div *ngIf="row.commission != null || row.commission != [] ">
                                                {{row.commission}}
                                            </div>
                                            <div *ngIf="row.commission != null || row.commission != [] ">
                                                0.00
                                            </div>
                                        </ng-template>
                                    </ngx-datatable-column>
                                    <ngx-datatable-column name="Sale Amount">
                                        <ng-template let-row="row" ngx-datatable-cell-template>
                                                {{row.amount |number : '1.2-2'}}         
                                        </ng-template>
                                    </ngx-datatable-column>
                                    <ngx-datatable-column name="Tax">
                                        <ng-template let-row="row" ngx-datatable-cell-template>
                                            <div *ngIf="row.tax != null || row.tax != [] ">
                                                {{row.tax}}
                                            </div>
                                            <div *ngIf="(row.tax == null || row.tax == []) ">
                                                ---
                                            </div>
                                        </ng-template>
                                    </ngx-datatable-column>
                                    <ngx-datatable-column name="Booking Status">
                                        <ng-template let-value="value" let-row="row" ngx-datatable-cell-template>
                                            <div class="recConfirm {{row.booking_status |lowercase}}">{{row.booking_status}}</div>
                                        </ng-template>
                                    </ngx-datatable-column>
                                    <ngx-datatable-column name="Booked Date" prop="created">
                                        <ng-template ngx-datatable-cell-template let-value="value">{{value | date: 'dd/MM/yyyy'}}
                                        </ng-template>
                                    </ngx-datatable-column>
                                </ngx-datatable>
                            </div>
                        </div>
                    </ng-container>
                </ng-container>
            </div>
        </div>
    </div>
    <jw-modal id="custom-modal-booking" class="report-booking-modal">
        <div class="ui" *ngIf="showDetailModal">
            <div class="header">
            </div>
            <div class="ui fluid container">
                <div class="form-inner">
                    <h4 class="ui  header"><span class="basic-header head">BOOKING INFORMATIONS</span></h4>
                    <i class="close icon" (click)="closeModal('custom-modal-booking');"></i>
                </div>
                <!-- <div class="field">
                    <hr>
                </div> -->
                <div class="form-inner">
                    <div class="field">
                        <table class="ui celled table">
                            <thead>
                                <tr>
                                    <th>Trip ID</th>
                                    <th>Ticket Number</th>
                                    <th>Lead Name</th>
                                    <th>Departure Airport</th>
                                    <th>Arrival Airport</th>
                                    <th>Service Name</th>
                                    <th>Departure Date</th>
                                    <th>Arrival Date</th>
                                    <th>Board Type</th>
                                    <th>Staff/User</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let data of newFilteredData;">
                                    <td>
                                        <span *ngIf="data.trip_id">{{data.trip_id}}</span>
                                        <span *ngIf="!data.trip_id">---</span>
                                    </td>
                                    <td>
                                        <span *ngIf="data.ticket_number">{{data.ticket_number}}</span>
                                        <span *ngIf="!data.ticket_number">---</span>
                                    </td>
                                    <td>
                                        <span *ngIf="getInfo.passenger_detail">
                      {{getInfo.passenger_detail.pax_first_name + ' ' + getInfo.passenger_detail.pax_middle_name + ' ' + getInfo.passenger_detail.pax_last_name}}
                    </span>
                                        <span *ngIf="!getInfo.passenger_detail">---</span>
                                    </td>
                                    <td>
                                        <span *ngIf="getInfo.trip_detail.trip_departure_airport_name!=null;else departure">
                      {{getInfo.trip_detail.trip_departure_airport_name}}
                    </span>
                                        <ng-template #departure>
                                            no data
                                        </ng-template>
                                    </td>
                                    <td>
                                        <span *ngIf="getInfo.trip_detail.trip_arrival_airport_name!=null;else arrival">
                      {{getInfo.trip_detail.trip_arrival_airport_name}}
                    </span>
                                        <ng-template #arrival>
                                            no data
                                        </ng-template>
                                    </td>
                                    <td>
                                        {{data.service_name}}
                                    </td>
                                    <td>
                                        <span *ngIf="getInfo.trip_detail.trip_departure_date!=null;else departure">
                      {{getInfo.trip_detail.trip_departure_date}}
                    </span>
                                    </td>
                                    <td>
                                        <span *ngIf="getInfo.trip_detail.trip_arrival_date!=null;else arrival">
                      {{getInfo.trip_detail.trip_arrival_date}}
                    </span>
                                    </td>
                                    <td>
                                        <span *ngIf="data.trip_detail">  {{getInfo.trip_detail.segment_detail.segment_seatingClass}}</span>
                                        <span *ngIf="!data.trip_detail">---</span>
                                    </td>
                                    <td>
                                        <span *ngIf="getInfo.user!=null ;else departure">
                      {{getInfo.user.username}}</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <h4 class="ui  header" *ngIf="showEMDtable"><span class="basic-header head">EMD INFORMATIONS</span>
                        </h4>
                        <h4 class="ui  header" *ngIf="!showEMDtable"><span class="basic-header">NOT AVAILABLE EMD
                INFORMATIONS</span>
                        </h4>
                        <table class="ui celled table" *ngIf="showEMDtable">
                            <thead>
                                <tr>
                                    <th>EMD NUMBER</th>
                                    <th>REASON FOR INSURANCE SUBCODE</th>
                                    <th>REMARKS</th>
                                    <th>AMOUNT</th>
                                    <th>CODE</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let emdDetail of emdDetails">
                                    <td>{{emdDetail.emd_number}}</td>
                                    <td>{{emdDetail.reason_for_issuance_subcode}}</td>
                                    <td>{{emdDetail.remarks}}</td>
                                    <td>{{emdDetail.amount}}</td>
                                    <td>{{emdDetail.code}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </jw-modal>
</div>